#
# Automations
#
automation.door_notify:
  extra_data_template:
  - >-
    var e = 'counter.door_notify';
    if (entities[e] === undefined || entities[e].state === 'unknown') return null;
    var max = entities[e].attributes['initial'],
        left = entities[e].state,
        name = entities[e].attributes['friendly_name'];
    if (left == max) return null;
    return max - left + '/' + max + ' ' + name.toLowerCase() + ' sent.'
  - >-
    if(!attributes.last_triggered)return null;
    var t,s=(new Date()-new Date(attributes.last_triggered))/1e3;
    return(
    (t=Math.floor(s/86400))?t+(t>1?" days":" day"):
    (t=Math.floor(s/3600))?t+(t>1?" hours":" hour"):
    (t=Math.floor(s/60))?t+(t>1?" minutes":" minute"):
    (t=Math.floor(s))!==1?t+" seconds":" second"
    )+" ago";
automation.humidity_notify:
  icon: mdi:water-percent
automation.front_door_notify:
  icon: mdi:door-open
automation.go_to_sleep:
  icon: mdi:weather-night
automation.theme_auto:
  icon: mdi:theme-light-dark
automation.scene_daylight:
  icon: mdi:weather-sunny
automation.scene_gaming:
  icon: mdi:google-controller
automation.scene_romantic:
  icon: mdi:home-heart
automation.scene_select:
  icon: mdi:looks
automation.smoke_notify:
  icon: mdi:smoke-detector
automation.update_notify:
  icon: mdi:cloud-upload
automation.wake_up:
  icon: mdi:power



#
# Cameras
#
camera.bing_wallpaper:
  hide_control: true
camera.noaa_geocolor:
  friendly_name: "Satellite: Geocolor"
  hide_control: true
camera.noaa_water_vapour:
  friendly_name: "Satellite: Water Vapour"
  hide_control: true


#
# Device trackers
#
device_tracker.cellphone_her:
  friendly_name: !secret nickname_her
  icon: mdi:cellphone-iphone
  extra_data_template:
    - >-
      var e = 'device_tracker.laptop_her';
      return entities[e] !== undefined && entities[e].state != 'unknown'
      ? entities[e].attributes['friendly_name'] + ' is ' + entities[e].state + '.'
      : null;
device_tracker.cellphone_him:
  friendly_name: !secret nickname_him
  icon: mdi:cellphone-iphone
  extra_data_template:
    - >-
      var e = 'device_tracker.laptop_him';
      return entities[e] !== undefined && entities[e].state != 'unknown'
      ? entities[e].attributes['friendly_name'] + ' is ' + entities[e].state + '.'
      : null;
device_tracker.laptop_her:
  friendly_name: Her laptop
  icon: mdi:laptop
device_tracker.laptop_him:
  friendly_name: His laptop
  icon: mdi:laptop


#
# Displays
#
display.kiosk:
  icon: mdi:tablet


#
# Groups
#
group.configuration_view:
  order: 5
group.default_view:
  order: 1
group.status_view:
  order: 4
group.switchboard_view:
  order: 2
group.weather_view:
  order: 3

#
# Sensors: Miscellaneous
#
sensor.bing_wallpaper:
  custom_ui_state_card: state-card-value_only
sensor.door_status:
  templates:
    theme: >-
      return state != 'Closed' ? 'card-warning'
      : null;
sensor.good_vibes:
  custom_ui_state_card: state-card-value_only
sensor.motion_status:
  templates:
    theme: >-
      return state != 'Clear' ? 'card-warning'
      : null;


#
# Sensors: Outdoor Life Quality
#
sensor.aqi_carbon_monoxide_friendly:
  extra_data_template: >-
    var e = 'sensor.aqi_carbon_monoxide';
    return entities[e] !== undefined && entities[e].state != 'unknown'
    ? entities[e].state + ' ' + entities[e].attributes['unit_of_measurement']
    : null;
  templates:
    theme: >-
      var e = 'sensor.aqi_carbon_monoxide',
          v = entities[e] !== undefined && parseInt(entities[e].state);
      return v > 100 ? 'card-critical'
      : v > 50 ? 'card-warning'
      : null;
sensor.aqi_friendly:
  extra_badge:
    entity_id: sensor.aqi
  extra_data_template: >-
    var e = 'sensor.aqi_stations_count',
        v = entities[e] !== undefined && parseInt(entities[e].state);
    return v > 1
    ? v + ' stations average'
    : null;
  templates:
    theme: >-
      var e = 'sensor.aqi',
          v = entities[e] !== undefined && parseInt(entities[e].state);
      return v > 100 ? 'card-critical'
      : v > 50 ? 'card-warning'
      : null;
sensor.aqi_nitrogen_dioxide_friendly:
  extra_data_template: >-
    var e = 'sensor.aqi_nitrogen_dioxide';
    return entities[e] !== undefined && entities[e].state != 'unknown'
    ? entities[e].state + ' ' + entities[e].attributes['unit_of_measurement']
    : null;
  templates:
    theme: >-
      var e = 'sensor.aqi_nitrogen_dioxide',
          v = entities[e] !== undefined && parseInt(entities[e].state);
      return v > 100 ? 'card-critical'
      : v > 50 ? 'card-warning'
      : null;
sensor.aqi_ozone_friendly:
  extra_data_template: >-
    var e = 'sensor.aqi_ozone';
    return entities[e] !== undefined && entities[e].state != 'unknown'
    ? entities[e].state + ' ' + entities[e].attributes['unit_of_measurement']
    : null;
  templates:
    theme: >-
      var e = 'sensor.aqi_ozone',
          v = entities[e] !== undefined && parseInt(entities[e].state);
      return v > 100 ? 'card-critical'
      : v > 50 ? 'card-warning'
      : null;
sensor.aqi_particles:
  device_class: pm25
sensor.aqi_particles_friendly:
  extra_data_template: >-
    var e = 'sensor.aqi_particles';
    return entities[e] !== undefined && entities[e].state != 'unknown'
    ? entities[e].state + ' ' + entities[e].attributes['unit_of_measurement']
    : null;
  templates:
    theme: >-
      var e = 'sensor.aqi_particles',
          v = entities[e] !== undefined && parseInt(entities[e].state);
      return v > 100 ? 'card-critical'
      : v > 50 ? 'card-warning'
      : null;
sensor.aqi_sulphur_dioxide_friendly:
  extra_data_template: >-
    var e = 'sensor.aqi_sulphur_dioxide';
    return entities[e] !== undefined && entities[e].state != 'unknown'
    ? entities[e].state + ' ' + entities[e].attributes['unit_of_measurement']
    : null;
  templates:
    theme: >-
      var e = 'sensor.aqi_sulphur_dioxide',
          v = entities[e] !== undefined && parseInt(entities[e].state);
      return v > 100 ? 'card-critical'
      : v > 50 ? 'card-warning'
      : null;
sensor.uv_friendly:
  extra_badge:
    entity_id: sensor.uv
  templates:
    theme: >-
      var e = 'sensor.uv',
          v = entities[e] !== undefined && parseInt(entities[e].state);
      return v >= 6 ? 'card-critical'
      : v >= 3 ? 'card-warning'
      : null;


#
# Sensors: Power
#
sensor.front_door_sensor_battery:
  group:
    group.battery:
      friendly_name: Front Door
      icon: mdi:door
    group.kitchen:
      friendly_name: Front Door Battery


#
# Sensors: System
#
sensor.processor_use:
  friendly_name: CPU Load
  icon: mdi:chip
  extra_data_template: >-
    var a = 'sensor.average_load',
        b = 'sensor.cpu_cores',
        c = (entities[a] !== undefined && entities[a].state != 'unknown')
            ? entities[a].state : null,
        d = (entities[b] !== undefined && entities[b].state != 'unknown')
            ? '(' + entities[b].state + ' cores)' : null;
    return c && d ? c + ' ' + d
    : c || d;
sensor.disk_use_percent:
  extra_data_template: >-
    var e = 'sensor.disk_free_home';
    return entities[e] !== undefined && entities[e].state != 'unknown'
    ? Math.round(parseFloat(entities[e].state)) + ' ' +
      entities[e].attributes['unit_of_measurement'] + ' available'
    : null;
sensor.ipv4_address_eth0:
  friendly_name: Local IP Address
sensor.memory_use_percent:
  extra_data_template: >-
    var e = 'sensor.memory_free';
    return entities[e] !== undefined && entities[e].state != 'unknown'
    ? Math.round(parseFloat(entities[e].state)) + ' ' +
      entities[e].attributes['unit_of_measurement'] + ' available'
    : null;
sensor.speedtest_download:
  friendly_name: Downspeed
  icon: mdi:download-network
  show_last_changed: true
sensor.speedtest_ping:
  friendly_name: Ping
  icon: mdi:timer
  show_last_changed: true
sensor.speedtest_upload:
  friendly_name: Upspeed
  icon: mdi:upload-network
  show_last_changed: true
sensor.uptime_os:
  icon: mdi:pi


#
# Sensors: Weather
#
sensor.dark_sky_minutely_summary:
  custom_ui_state_card: state-card-value_only
sensor.dark_sky_daily_summary:
  friendly_name: Weekly Forecast
  hide_control: true
  custom_ui_state_card: state-card-value_only
sensor.dark_sky_hourly_summary:
  friendly_name: 24h Summary
  custom_ui_state_card: state-card-value_only
sensor.dark_sky_summary:
  friendly_name: " "
  extra_data_template: >-
    var e = 'sensor.outside_temperature';
    return entities[e] !== undefined && entities[e].state != 'unknown'
    ? entities[e].state + entities[e].attributes['unit_of_measurement']
    : null;
  theme: card-secondary-title
sensor.outside_humidity:
  friendly_name: Outside
sensor.outside_temperature:
  friendly_name: Outside
sensor.weather_details:
  custom_ui_state_card: state-card-value_only
sensor.wind_speed:
  extra_badge:
    entity_id: sensor.dark_sky_wind_speed
  templates:
    theme: >-
      var v = parseInt(state);
      return v >= 40 ? 'card-critical'
      : v >= 20 ? 'card-warning'
      : null;


#
# Scenes
#
scene.romantic:
  icon: mdi:heart
scene.shutdown:
  icon: mdi:power


#
# Updater
#
updater.updater:
  custom_ui_state_card: state-card-custom-ui
  extra_data_template: >-
    var e = 'sensor.current_version';
    return entities[e] !== undefined && entities[e].state != 'unknown'
    ? 'Current version: ' + entities[e].state
    : null;
